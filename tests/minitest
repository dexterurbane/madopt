#/bin/bash

OPTIND=1
op=""
n="5"
a="1"

while getopts "on:a:" opt; do
    case "$opt" in
    o)  op="-O2"
        ;;
    n)  n=$OPTARG
        ;;
    a)  a=$OPTARG
        ;;
    esac
done
shift $((OPTIND-1))

cd ../build
cmake -DCMAKE_BUILD_TYPE=Release ..
make

rc=$?
if [[ $rc != 0 ]] ; then
    echo "GCC Failed"
    exit $rc
fi

cd ../tests

/usr/bin/time -f "\nCommand=%C\n\tExit Code=%x\n\tMaxMem=%M\n\tRuntime=%e/%S/%U" ../build/minitest -n $n -a $a
